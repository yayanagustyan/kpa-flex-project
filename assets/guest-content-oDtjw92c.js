import{r as v,d as U,f as m,o as F,w as K,c as h,a as e,g as x,t as c,u,h as E,v as R,b as p,F as P,i as T,j as S,k as Y,e as b,n as q}from"./index-YK-W7pQ9.js";import{G as L}from"./guest-repository-blUwvxSf.js";const n=v([]),f=v([]),y=v(!1),g=v(!1),w=v(!1),j=v(!0);let k=v("");const O=20,_=new L;async function N(){f.value=await _.loadPrev(),n.value=await _.load(),j.value=!1}function W(a){return a.id!=0?f.value.findIndex(l=>l.id===a.id)!==-1:!1}function H(a){const d=f.value.find(l=>l.id===a.id);d&&M(d,!0,"revert")}function J(a,d){const l=n.value.find(o=>o.id===a.id);if(l){const o=f.value.findIndex(i=>i.id===a.id);o!==-1?d=="revert"?f.value.splice(o,1):f.value[o]={...l}:a.email!==l.email&&f.value.push(l),_.savePrev(f.value)}}function M(a,d,l){if(!a.email||a.tickets==0)k.value="Please fill all fields",y.value=!0;else{if(d){J(a,l);const o=n.value.findIndex(i=>i.id===a.id);o!==-1&&(n.value[o]={...a})}else if(n.value.length<O)if(n.value.findIndex(i=>i.email===a.email)!==-1)k.value="Email already exist!",y.value=!0;else{const i=Math.max(0,...n.value.map(C=>C.id))+1;n.value.push({...a,id:i})}else k.value="You have reached the data insertion quota.",y.value=!0;_.save(n.value),g.value=!1}}function Q(a){const d=n.value.findIndex(l=>l.id===a);d!==-1&&n.value.splice(d,1),_.save(n.value),w.value=!1}async function X(){j.value=!0,n.value=[],await _.reset(),N()}const Z=e("b",null,"Guests",-1),ee=e("div",{class:"divider"},null,-1),te={class:"flex items-center justify-between text-white mt-4"},se={class:"text-black text-sm"},le=e("option",{value:5},"5",-1),oe=e("option",{value:10},"10",-1),ae=e("option",{value:25},"25",-1),ne=e("option",{value:50},"50",-1),ie=[le,oe,ae,ne],de=e("i",{class:"mdi mdi-plus-outline"},null,-1),re=e("span",null,"Add New Guest",-1),ue=e("span",null,"Reset",-1),ce=[ue],ve={class:"overflow-x-auto mt-4"},he={class:"min-w-full table-auto border bg-gray-800 text-white"},be=e("thead",{class:"bg-gray-800 text-left"},[e("tr",null,[e("th",{class:"px-4 py-2 border"},"#"),e("th",{class:"px-4 py-2 border"},"Tickets"),e("th",{class:"px-4 py-2 border"},"Email"),e("th",{class:"px-4 py-2 border text-center"},"Tools")])],-1),xe={key:0},fe=e("td",{colspan:"4"},[e("div",{class:"p-3"},"loading....")],-1),_e=[fe],pe={class:"px-4 py-2 border"},ye={class:"px-4 py-2 border"},me={class:"px-4 py-2 border"},ge={class:"px-4 py-2 border"},we={class:"flex-gap-15 flex-center"},ke=["onClick"],Ce=e("i",{class:"mdi mdi-pencil-outline"},null,-1),$e=[Ce],Ge=["onClick"],Pe=e("i",{class:"mdi mdi-delete-outline"},null,-1),Me=[Pe],je={class:"mt-4 flex items-center justify-end space-x-2"},Ie={class:"flex border border-gray-400 rounded"},De=["disabled"],Ee=["onClick"],Te=["disabled"],Ne={key:0,id:"modal",class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ve={class:"bg-white rounded-lg shadow-lg w-full max-w-md p-6"},ze={class:"text-xl font-bold mb-4"},Ae=e("span",{class:"text-gray-500"},"Tickets",-1),Be=e("br",null,null,-1),Ue={class:"mt-2"},Fe=e("span",{class:"text-gray-500"},"Email",-1),Ke={key:0,class:"mt-1 mb-3 text-sm"},Re=e("span",null,"Undo the last change?",-1),Se=e("div",{class:"divider mb-3"},null,-1),Ye={class:"flex justify-end space-x-2"},qe={key:1,id:"delmodal",class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Le={class:"bg-white rounded-lg shadow-lg w-full max-w-md p-6"},Oe=e("h2",{class:"text-xl font-bold mb-4"},"Delete Confirmation",-1),We=e("p",null,"Are you sure to delete this data?",-1),He={class:"flex justify-end space-x-2 mt-5"},Je={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Qe={class:"bg-white rounded-lg shadow-lg w-full max-w-md p-6"},Xe=e("h2",{class:"text-xl font-bold mb-4"},[e("i",{class:"mdi mdi-alert-outline"}),x(" Warning!")],-1),Ze={class:"flex justify-end space-x-2 mt-5"},st=U({__name:"guest-content",setup(a){const d=v(!1),l=v({id:0,email:"",tickets:0}),o=v(1),i=v(5),C=m(()=>(o.value-1)*i.value+1),V=m(()=>{const r=o.value*i.value;return r>n.value.length?n.value.length:r}),$=m(()=>Math.ceil(n.value.length/i.value)),z=m(()=>{const r=(o.value-1)*i.value;return n.value.slice(r,r+i.value)});function G(r){r>=1&&r<=$.value&&(o.value=r)}F(async()=>{N()});function I(r,t){d.value=r=="edit",g.value=!0,t.id==0&&(t.tickets=Date.now()),l.value={...t}}function A(r){w.value=!0,l.value={...r}}return K(i,()=>{o.value=1}),(r,t)=>(b(),h(P,null,[Z,ee,e("div",te,[e("div",null,[e("span",se,[x("show "),e("b",null,c(C.value)+" to "+c(V.value),1),x(" of "),e("b",null,c(u(n).length),1),x(" data(s)")]),x("    "),E(e("select",{id:"perPage","onUpdate:modelValue":t[0]||(t[0]=s=>i.value=s),class:"border rounded px-6 text-sm text-gray-800"},ie,512),[[R,i.value]])]),e("div",null,[e("button",{class:"px-4 py-2 bg-gray-800 text-white border border-gray-800 rounded text-sm hover:bg-gray-100 hover:text-gray-800",onClick:t[1]||(t[1]=s=>I("add",{id:0,email:"",tickets:0}))},[de,x("  "),re]),x("   "),e("button",{class:"px-4 py-2 bg-gray-800 text-white border border-gray-800 rounded text-sm hover:bg-gray-100 hover:text-gray-800",onClick:t[2]||(t[2]=s=>u(X)())},ce)])]),e("div",ve,[e("table",he,[be,e("tbody",null,[u(j)?(b(),h("tr",xe,_e)):p("",!0),(b(!0),h(P,null,T(z.value,(s,D)=>(b(),h("tr",{key:s.id,class:"hover:bg-gray-700"},[e("td",pe,c((o.value-1)*i.value+D+1),1),e("td",ye,c(s.tickets),1),e("td",me,c(s.email),1),e("td",ge,[e("div",we,[e("div",{class:"icon-tools",onClick:B=>I("edit",s)},$e,8,ke),e("div",{class:"icon-tools",onClick:B=>A(s)},Me,8,Ge)])])]))),128))])]),e("div",je,[e("div",Ie,[e("button",{onClick:t[3]||(t[3]=s=>G(o.value-1)),disabled:o.value===1,class:"px-3 py-1 bg-gray-200 rounded disabled:text-gray-400"}," « ",8,De),(b(!0),h(P,null,T($.value,s=>(b(),h("button",{key:s,onClick:D=>G(s),class:q(["px-3 py-1",o.value===s?"bg-gray-800 text-white":"bg-gray-200"])},c(s),11,Ee))),128)),e("button",{onClick:t[4]||(t[4]=s=>G(o.value+1)),disabled:o.value===$.value,class:"px-3 py-1 bg-gray-200 rounded disabled:text-gray-400"}," » ",8,Te)])])]),u(g)?(b(),h("div",Ne,[e("div",Ve,[e("h2",ze,c(d.value?"Edit Guest":"Add New Guest"),1),e("div",null,[Ae,Be,e("b",null,c(l.value.tickets),1)]),e("div",Ue,[Fe,E(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>l.value.email=s),type:"text",placeholder:"Guest Email",class:"w-full border p-2 mb-4 rounded",onKeydown:t[6]||(t[6]=Y(s=>u(M)(l.value,d.value,"new"),["enter"]))},null,544),[[S,l.value.email]])]),u(W)(l.value)?(b(),h("div",Ke,[Re,x(),e("span",{class:"undo-me",onClick:t[7]||(t[7]=s=>u(H)(l.value))},"Yes, let's do it!")])):p("",!0),Se,e("div",Ye,[e("button",{onClick:t[8]||(t[8]=s=>g.value=!1),class:"px-4 py-1 border border-gray-800 bg-white rounded hover:bg-gray-800 hover:text-white"}," Cancel "),e("button",{onClick:t[9]||(t[9]=s=>u(M)(l.value,d.value,"new")),class:"px-4 py-1 bg-gray-800 border border-gray-800 text-white rounded hover:bg-white hover:text-gray-800"}," Confirm ")])])])):p("",!0),u(w)?(b(),h("div",qe,[e("div",Le,[Oe,We,e("pre",null,"`"+c(l.value.email)+"`",1),e("div",He,[e("button",{onClick:t[10]||(t[10]=s=>w.value=!1),class:"px-4 py-1 border border-gray-800 bg-gray-100 rounded hover:bg-gray-800 hover:text-white"}," Cancel "),e("button",{onClick:t[11]||(t[11]=s=>u(Q)(l.value.id)),class:"px-4 py-1 bg-gray-800 border border-gray-800 text-white rounded hover:bg-gray-100 hover:text-gray-800"}," Confirm ")])])])):p("",!0),u(y)?(b(),h("div",Je,[e("div",Qe,[Xe,e("p",null,c(u(k)),1),e("div",Ze,[e("button",{onClick:t[12]||(t[12]=s=>y.value=!1),class:"px-4 py-2 border border-gray-800 bg-white text-sm rounded hover:bg-gray-800 hover:text-white"}," Okay, I got it ")])])])):p("",!0)],64))}});export{st as default};
