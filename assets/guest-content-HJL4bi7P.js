import{r as u,d as M,o as j,c,a as e,t as v,u as n,f as p,b,F as $,g as T,w as N,v as P,h as R,e as f}from"./index-OZahp6S2.js";import{G as V}from"./guest-repository-blUwvxSf.js";const a=u([]),h=u([]),_=u(!1),y=u(!1),g=u(!1),G=u(!0);let w=u("");const z=20,x=new V;async function I(){h.value=await x.loadPrev(),a.value=await x.load(),G.value=!1}function A(l){return l.id!=0?h.value.findIndex(t=>t.id===l.id)!==-1:!1}function B(l){const i=h.value.find(t=>t.id===l.id);i&&C(i,!0,"revert")}function F(l,i){const t=a.value.find(d=>d.id===l.id);if(t){const d=h.value.findIndex(r=>r.id===l.id);d!==-1?i=="revert"?h.value.splice(d,1):h.value[d]={...t}:l.email!==t.email&&h.value.push(t),x.savePrev(h.value)}}function C(l,i,t){if(!l.email||l.tickets==0)w.value="Please fill all fields",_.value=!0;else{if(i){F(l,t);const d=a.value.findIndex(r=>r.id===l.id);d!==-1&&(a.value[d]={...l})}else if(a.value.length<z)if(a.value.findIndex(r=>r.email===l.email)!==-1)w.value="Email already exist!",_.value=!0;else{const r=Math.max(0,...a.value.map(k=>k.id))+1;a.value.push({...l,id:r})}else w.value="You have reached the data insertion quota.",_.value=!0;x.save(a.value),y.value=!1}}function K(l){const i=a.value.findIndex(t=>t.id===l);i!==-1&&a.value.splice(i,1),x.save(a.value),g.value=!1}async function U(){G.value=!0,a.value=[],await x.reset(),I()}const Y=e("b",null,"Guests",-1),q=e("div",{class:"divider"},null,-1),L={class:"flex items-center justify-between text-white mt-4"},O={class:"text-black text-sm"},S=e("i",{class:"mdi mdi-plus-outline"},null,-1),W=e("span",null,"Add New Guest",-1),H=e("span",null,"Reset",-1),J=[H],Q={class:"overflow-x-auto mt-4"},X={class:"min-w-full table-auto border bg-gray-800 text-white"},Z=e("thead",{class:"bg-gray-800 text-left"},[e("tr",null,[e("th",{class:"px-4 py-2 border"},"#"),e("th",{class:"px-4 py-2 border"},"Tickets"),e("th",{class:"px-4 py-2 border"},"Email"),e("th",{class:"px-4 py-2 border text-center"},"Tools")])],-1),ee={key:0},te=e("td",{colspan:"4"},[e("div",{class:"p-3"},"loading....")],-1),se=[te],le={class:"px-4 py-2 border"},oe={class:"px-4 py-2 border"},ie={class:"px-4 py-2 border"},ae={class:"px-4 py-2 border"},ne={class:"flex-gap-15 flex-center"},de=["onClick"],re=e("i",{class:"mdi mdi-pencil-outline"},null,-1),ue=[re],ce=["onClick"],ve=e("i",{class:"mdi mdi-delete-outline"},null,-1),fe=[ve],he={key:0,id:"modal",class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},xe={class:"bg-white rounded-lg shadow-lg w-full max-w-md p-6"},be={class:"text-xl font-bold mb-4"},pe=e("span",{class:"text-gray-500"},"Tickets",-1),_e=e("br",null,null,-1),me={class:"mt-2"},ye=e("span",{class:"text-gray-500"},"Email",-1),ge={key:0,class:"mt-1 mb-3 text-sm"},we=e("span",null,"Undo the last change?",-1),ke=e("div",{class:"divider mb-3"},null,-1),Ce={class:"flex justify-end space-x-2"},Ge={key:1,id:"delmodal",class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},$e={class:"bg-white rounded-lg shadow-lg w-full max-w-md p-6"},Ie=e("h2",{class:"text-xl font-bold mb-4"},"Delete Confirmation",-1),De=e("p",null,"Are you sure to delete this data?",-1),Ee={class:"flex justify-end space-x-2 mt-5"},Me={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},je={class:"bg-white rounded-lg shadow-lg w-full max-w-md p-6"},Te=e("h2",{class:"text-xl font-bold mb-4"},[e("i",{class:"mdi mdi-alert-outline"}),p(" Warning!")],-1),Ne={class:"flex justify-end space-x-2 mt-5"},Ve=M({__name:"guest-content",setup(l){const i=u(!1),t=u({id:0,email:"",tickets:0}),d=u(null);j(async()=>{I()});function r(m,s){var o;i.value=m=="edit",y.value=!0,s.id==0&&(s.tickets=Date.now()),(o=d.value)==null||o.focus(),t.value={...s}}function k(m){g.value=!0,t.value={...m}}return(m,s)=>(f(),c($,null,[Y,q,e("div",L,[e("span",O,[e("b",null,v(n(a).length),1),p(" data(s) available")]),e("div",null,[e("button",{class:"px-4 py-2 bg-gray-800 text-white border border-gray-800 rounded text-sm hover:bg-gray-100 hover:text-gray-800",onClick:s[0]||(s[0]=o=>r("add",{id:0,email:"",tickets:0}))},[S,p("  "),W]),p("   "),e("button",{class:"px-4 py-2 bg-gray-800 text-white border border-gray-800 rounded text-sm hover:bg-gray-100 hover:text-gray-800",onClick:s[1]||(s[1]=o=>n(U)())},J)])]),e("div",Q,[e("table",X,[Z,e("tbody",null,[n(G)?(f(),c("tr",ee,se)):b("",!0),(f(!0),c($,null,T(n(a),(o,D)=>(f(),c("tr",{key:o.id,class:"hover:bg-gray-700"},[e("td",le,v(D+1),1),e("td",oe,v(o.tickets),1),e("td",ie,v(o.email),1),e("td",ae,[e("div",ne,[e("div",{class:"icon-tools",onClick:E=>r("edit",o)},ue,8,de),e("div",{class:"icon-tools",onClick:E=>k(o)},fe,8,ce)])])]))),128))])])]),n(y)?(f(),c("div",he,[e("div",xe,[e("h2",be,v(i.value?"Edit Guest":"Add New Guest"),1),e("div",null,[pe,_e,e("b",null,v(t.value.tickets),1)]),e("div",me,[ye,N(e("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>t.value.email=o),type:"text",placeholder:"Guest Email",class:"w-full border p-2 mb-4 rounded",ref_key:"inputRef",ref:d,onKeydown:s[3]||(s[3]=R(o=>n(C)(t.value,i.value,"new"),["enter"]))},null,544),[[P,t.value.email]])]),n(A)(t.value)?(f(),c("div",ge,[we,p(),e("span",{class:"undo-me",onClick:s[4]||(s[4]=o=>n(B)(t.value))},"Yes, let's do it!")])):b("",!0),ke,e("div",Ce,[e("button",{onClick:s[5]||(s[5]=o=>y.value=!1),class:"px-4 py-1 border border-gray-800 bg-white rounded hover:bg-gray-800 hover:text-white"}," Cancel "),e("button",{onClick:s[6]||(s[6]=o=>n(C)(t.value,i.value,"new")),class:"px-4 py-1 bg-gray-800 border border-gray-800 text-white rounded hover:bg-white hover:text-gray-800"}," Confirm ")])])])):b("",!0),n(g)?(f(),c("div",Ge,[e("div",$e,[Ie,De,e("pre",null,"`"+v(t.value.email)+"`",1),e("div",Ee,[e("button",{onClick:s[7]||(s[7]=o=>g.value=!1),class:"px-4 py-1 border border-gray-800 bg-gray-100 rounded hover:bg-gray-800 hover:text-white"}," Cancel "),e("button",{onClick:s[8]||(s[8]=o=>n(K)(t.value.id)),class:"px-4 py-1 bg-gray-800 border border-gray-800 text-white rounded hover:bg-gray-100 hover:text-gray-800"}," Confirm ")])])])):b("",!0),n(_)?(f(),c("div",Me,[e("div",je,[Te,e("p",null,v(n(w)),1),e("div",Ne,[e("button",{onClick:s[9]||(s[9]=o=>_.value=!1),class:"px-4 py-2 border border-gray-800 bg-white text-sm rounded hover:bg-gray-800 hover:text-white"}," Okay, I got it ")])])])):b("",!0)],64))}});export{Ve as default};
